/**

  Export of gridder poblaciÃ³n data.

*/
create materialized view export.poblacion as

select
  (data ->> '5383f')::numeric as pobtot_02,
  (data ->> '3d28')::numeric as pobhom_02,
  (data ->> '8d73')::numeric as pobmuj_02,
  (data ->> 'd0ad')::numeric as pob017_02,
  (data ->> '3eb7')::numeric as pob1864_02,
  (data ->> '2555')::numeric as pob64_02,
  (data ->> 'efc7')::numeric as pobam_02,
  (data ->> '53dea')::numeric as pobesp_02,
  (data ->> '2fa5d')::numeric as pobeu_02,
  (data ->> '2951')::numeric as pobmag_02,
  (data ->> '57c7')::numeric as pobotros_02,
  (data ->> '52ed')::numeric as inddeptot_02,
  (data ->> '8fd3d')::numeric as inddepin_02,
  (data ->> '9416')::numeric as inddepan_02,

  (data ->> 'f4805')::numeric as pobtot_13,
  (data ->> '3547')::numeric as pobhom_13,
  (data ->> 'cdd2')::numeric as pobmuj_13,
  (data ->> 'cd33')::numeric as pob017_13,
  (data ->> 'c02a')::numeric as pob1864_13,
  (data ->> '1f35')::numeric as pob64_13,
  (data ->> '2e47b')::numeric as pobam_13,
  (data ->> 'd97e')::numeric as pobesp_13,
  (data ->> '0e061')::numeric as pobeu_13,
  (data ->> '29e1e')::numeric as pobmag_13,
  (data ->> '667d')::numeric as pobotros_13,
  (data ->> '871c')::numeric as inddeptot_13,
  (data ->> '7c8c')::numeric as inddepin_13,
  (data ->> 'cf1f')::numeric as inddepan_13,

  (data ->> '4892')::numeric as pobtot_14,
  (data ->> 'a621')::numeric as pobhom_14,
  (data ->> 'e8dc1')::numeric as pobmuj_14,
  (data ->> '4a29')::numeric as pob017_14,
  (data ->> 'd4ce')::numeric as pob1864_14,
  (data ->> '37eec')::numeric as pob64_14,
  (data ->> '24e0e')::numeric as pobam_14,
  (data ->> 'cf13')::numeric as pobesp_14,
  (data ->> '6e73')::numeric as pobeu_14,
  (data ->> 'ccea1')::numeric as pobmag_14,
  (data ->> 'e9579')::numeric as pobotros_14,
  (data ->> 'a3d6')::numeric as inddeptot_14,
  (data ->> 'b426')::numeric as inddepin_14,
  (data ->> 'e3f8f')::numeric as inddepan_14,

  (data ->> '8186')::numeric as pobtot_15,
  (data ->> '75d3')::numeric as pobhom_15,
  (data ->> 'ffa2b')::numeric as pobmuj_15,
  (data ->> '3d21')::numeric as pob017_15,
  (data ->> '9382c')::numeric as pob1864_15,
  (data ->> 'bebf')::numeric as pob64_15,
  (data ->> '0f55d')::numeric as pobam_15,
  (data ->> 'e589')::numeric as pobesp_15,
  (data ->> 'df3b')::numeric as pobeu_15,
  (data ->> '87d1')::numeric as pobmag_15,
  (data ->> '8ac5')::numeric as pobotros_15,
  (data ->> '9789')::numeric as inddeptot_15,
  (data ->> '796d')::numeric as inddepin_15,
  (data ->> '6108')::numeric as inddepan_15,

  (data ->> '204a')::numeric as pobtot_16,
  (data ->> '567c')::numeric as pobhom_16,
  (data ->> 'e0762')::numeric as pobmuj_16,
  (data ->> 'f48d')::numeric as pop017_16,
  (data ->> '8b66')::numeric as pob1864_16,
  (data ->> '6ae0')::numeric as pob64_16,
  (data ->> '05a2')::numeric as pobam_16,
  (data ->> '6fdf')::numeric as pobesp_16,
  (data ->> '630c')::numeric as pobeu_16,
  (data ->> '4302')::numeric as pobmag_16,
  (data ->> 'dfba')::numeric as pobotros_16,
  (data ->> 'fe2f')::numeric as inddeptot_2016,
  (data ->> '5c96')::numeric as inddepin_16,
  (data ->> '1810')::numeric as inddepan_16,

  (data ->> '9892')::numeric as pobtot_17,
  (data ->> '26f8')::numeric as pobhom_17,
  (data ->> '5807')::numeric as pobmuj_17,
  (data ->> '3b20')::numeric as pob017_17,
  (data ->> 'b82c')::numeric as pob1864_17,
  (data ->> '8f9e')::numeric as pob64_17,
  (data ->> '90e1')::numeric as pobam_17,
  (data ->> '0670')::numeric as pobesp_17,
  (data ->> 'a461')::numeric as pobeu_17,
  (data ->> '8956')::numeric as pobmag_17,
  (data ->> '21da')::numeric as pobotros_17,
  (data ->> '57ea')::numeric as inddeptot_17,
  (data ->> '9fb0')::numeric as inddepin_17,
  (data ->> '0a7e')::numeric as inddepan_17,

  (data ->> 'a57c')::numeric as pobtot_18,
  (data ->> '3cd1')::numeric as pobhom_18,
  (data ->> '667d6')::numeric as pobmuj_18,
  (data ->> '95f4')::numeric as pob017_18,
  (data ->> '1db1')::numeric as pob1864_18,
  (data ->> '8e93')::numeric as pob64_18,
  (data ->> 'c416')::numeric as pobam_18,
  (data ->> '1041')::numeric as pobesp_18,
  (data ->> '1fe8')::numeric as pobeu_18,
  (data ->> '3a72')::numeric as pobmag_18,
  (data ->> 'a55f')::numeric as pobotros_18,
  (data ->> '64a78')::numeric as inddeptot_18,
  (data ->> '4523')::numeric as inddepin_18,
  (data ->> '75fe')::numeric as inddepan_18,

  x, y, zoom,
  st_transform(
    cell__cellgeom((grid_id, epsg, zoom, x, y, '{}'::jsonb)::cell__cell),
    4326
  ) as geom
from cell_data.data
where
  data -> 'e6b8' is not null;
--limit 10;
